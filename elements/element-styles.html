<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="element-stuff.html">

<dom-module id="element-styles">
  <template>
    <style>
      :host{
        display: block;
        box-sizing: border-box;
      }
      label, input, select {
        height: 24px;
        margin: 2px 0;
        padding: 0 2px 0 4px;
        width: 140px;
      }
      label {
        float: left;
        display: block;
        margin-right: 20px;
        font-size: 13px;
      }
      input, select {
        border: 1px solid #d4d4d4;
        border-radius: 3px;
        box-sizing: border-box;
        font-size: 11px;
      }
      input[type="color"] {
        width: 50px;
        background: none;
      }
      input[disabled] {
        color: #BDBDBD;
      }
      select {
        background: transparent;
      }
      .style-label {
        width: 150px;
        margin-right: 14px;
      }
    </style>
    <div id="container">
      <label>color</label><input name="color" type="color"><br>
      <label>background color</label><input name="backgroundColor" type="color">
      <label>box-sizing</label>
      <select name="box-sizing">
        <option>border-box</option>
        <option>content-box</option>
      </select>
      <label>border</label><input name="border">
      <label>box shadow</label><input name="boxShadow">
      <label>opacity</label><input name="opacity" type="text" min="0" max="1" step="0.1" value="1">
      <label>padding</label><input name="padding">
      <label>margin</label><input name="margin">
      <label>position</label>
      <select name="position">
        <option>static</option>
        <option>absolute</option>
        <option>relative</option>
      </select>
      <label>left</label><input name="left">
      <label>top</label><input name="top">
      <label>width</label><input name="width">
      <label>height</label><input name="height">
    </div>
    <button on-click="addStyle">Add style</button>
  </template>
  <script>
    class ElementStyles extends ElementStuff(Polymer.Element) {
      static get is() { return 'element-styles'; }
      static get properties() {
        return {
          stuffType: {type: String, value: 'style'}
        }
      }
      display(elementStyles) {
        for (var i = 0; i < this._stuff.length; i++) {
          var name = this._stuff[i];
          if (!elementStyles[name])
            continue;
          var el = this.root.querySelector(`[name=${name}]`);
          if (name === 'backgroundColor' || name === 'color') {
            el.value = this._rgb2hex(elementStyles[name]);
          } else {
            el.value = elementStyles[name];
          }
        }
      }
      addStyle(event) {
        var label = document.createElement('input');
        label.className = 'style-label';
        var input = document.createElement('input');
        input.className = 'style-value';
        this.$.container.appendChild(label);
        this.$.container.appendChild(input);
      }
      _rgb2hex(rgb) {
       rgb = rgb.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);
       return (rgb && rgb.length === 4) ? "#" +
        ("0" + parseInt(rgb[1],10).toString(16)).slice(-2) +
        ("0" + parseInt(rgb[2],10).toString(16)).slice(-2) +
        ("0" + parseInt(rgb[3],10).toString(16)).slice(-2) : '';
      }
    }
    customElements.define(ElementStyles.is, ElementStyles);
  </script>
</dom-module>
